{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="mx-auto max-w-6xl px-4 py-6">

  <!-- Filter form (AJAX) -->
  <form id="filter-form" method="get"
        class="bg-white border rounded-lg p-4 mb-6 flex flex-col sm:flex-row gap-3 sm:items-center">
    <input type="text" name="category" placeholder="Cari kategori…"
           class="flex-1 border rounded-md px-3 py-2">
    <div class="flex gap-2">
      <button type="submit" class="border px-4 py-2 rounded-md bg-white">Filter</button>
      <a href="#" id="filter-clear" class="border px-4 py-2 rounded-md bg-white">Clear</a>
    </div>
  </form>

  <!-- Info data delivery -->
  <div class="text-center text-gray-700 text-sm mb-3">
    Data Delivery:
    <a href="{% url 'main:products_json' %}" class="underline hover:no-underline">JSON</a> |
    <a href="{% url 'main:products_xml' %}" class="underline hover:no-underline">XML</a>
  </div>

  <!-- Header + actions (Refresh) -->
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-xl font-semibold text-black">Produk Saya</h1>
    <div class="flex gap-2">
      <button id="btn-refresh" class="px-3 py-2 rounded border">Refresh</button>
    </div>
  </div>

  <!-- States -->
  <p id="state-loading" class="text-gray-500 hidden">Loading…</p>
  <p id="state-error" class="text-red-600 hidden"></p>
  <p id="state-empty" class="text-gray-500 hidden">Belum ada produk.</p>

  <!-- AJAX list target -->
  <div id="product-list" class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3"></div>
</div>
{% endblock %}

{% block extra_js %}
  <!-- Toast global HARUS lebih dulu -->
  <script src="{% static 'js/toast.js' %}"></script>
  <!-- Script utama -->
  <script src="{% static 'js/products.js' %}"></script>
{% endblock %}
